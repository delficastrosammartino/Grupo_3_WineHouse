<!DOCTYPE html>
<html lang="en">

  <head>
    <%- include("../partials/head.ejs") %>
    <link rel="stylesheet" href="/css/crear-producto.css" />
  </head>

  <body>
    <%- include("../partials/header.ejs") %>

    <main>
      <div class="contenedor-titulo">
        <h3 class="title">Formulario de creación de productos:</h3>

      </div>

        <div class="contenedor-form">
          <form id="form" action="/products" method="POST" enctype="multipart/form-data">
            <div class="errores">
              <ul></ul>
            </div>
            <div class="contenedor-inputs">
              <div class="label-input">
                <label class="form-label">Nombre del producto:</label>
                <input
                  type="text"
                  id="name"
                  name="name"
                  placeholder="Ej: Luigi Bosca Pinot Noir"
                  class="form-input"
                  value="<%= locals.oldData ? oldData.name : null %>"/>
              </div>
              <% if(locals.errors && errors.name) {%>
              <div class="text-danger errores"><%= errors.name.msg %></div>
              <% } %>

              <div class="label-input">
                <label for="price" class="form-label">Precio:</label>
                <input
                  type="text"
                  id="price"
                  name="price"
                  placeholder="Ej: 222"
                  class="form-input"
                  value="<%= locals.oldData ? oldData.price : null %>"
                />
              </div>
              <% if(locals.errors && errors.price) {%>
              <div class="text-danger errores"><%= errors.price.msg %></div>
              <% } %>

              <div class="label-input">
                <label for="discount" class="form-label">Descuento:</label>
                <input
                  type="text"
                  id="discount"
                  name="discount"
                  placeholder="Ej: 15"
                  class="form-input"
                  value="<%= locals.oldData ? oldData.discount : null %>"
                />

              </div>
              <% if(locals.errors && errors.discount) {%>
              <div class="text-danger errores"><%= errors.discount.msg %></div>
              <% } %>

              <div class="label-input">
                <label for="size" class="form-label">Tamaño:</label>
                <p>
                  <select name="size" id="size">
                    <option
                      value=""
                      disabled
                      selected>
                      - selecciona el tamaño -
                    </option>

                    <% if (locals.oldData) { %>
                      <% sizes.forEach(size => { %>
                        <option 
                          value="<%= size.id %>" 
                          <%= (size.id==oldData.size)?'selected':'' %>>
                          <%=size.name %>
                        </option>
                    <% }) %>
                    <% } else { %>
                      <% sizes.forEach(size => { %>
                      <option value="<%= size.id %>"><%=size.name %></option>
                      <% }) %>
                    <% } %>
                  </select>
                  <br />
                </p>
              </div>

              <% if(locals.errors && errors.size) {%>
              <div class="text-danger errores"><%= errors.size.msg %></div>
              <% } %>

              <div class="label-input">
                <label for="bodega" class="form-label">Bodega:</label>
                <p>
                  <select name="bodega" id="bodega">
                    <option
                      value=""
                      disabled
                      selected
                    >
                      - selecciona la bodega -
                    </option>
                    <% if (locals.oldData) { %>
                      <% bodegas.forEach(bodega => { %>
                        <option value="<%= bodega.id %>" 
                          <%= (bodega.id==oldData.bodega)?'selected':'' %>
                          ><%=bodega.name %></option>
                    <% }) %>
                    <% } else { %>
                      <% bodegas.forEach(bodega => { %>
                      <option value="<%= bodega.id %>"><%=bodega.name %></option>
                      <% }) %>
                    <% } %>
                  </select>
                  <br />
                </p>
              </div>

              <% if(locals.errors && errors.bodega) {%>
              <div class="text-danger errores"><%= errors.bodega.msg %></div>
              <% } %>

              <div class="label-input">
                <label for="province" class="form-label">Provincia:</label>
                <p>
                  <select name="province" id="province">
                    <option
                      value=""
                      disabled
                      selected
                    >
                      - selecciona la provincia -
                    </option>
                    <% if (locals.oldData) { %>
                      <% provinces.forEach(province => { %>
                        <option value="<%= province.id %>" 
                          <%= (province.id==oldData.province)?'selected':'' %>
                          ><%=province.name %></option>
                    <% }) %>
                    <% } else { %>
                      <% provinces.forEach(province => { %>
                      <option value="<%= province.id %>"><%=province.name %></option>
                      <% }) %>
                    <% } %>
                  </select>
                  <br />
                </p>
              </div>

              <% if(locals.errors && errors.province) {%>
              <div class="text-danger errores"><%= errors.province.msg %></div>
              <% } %>

              <div class="label-input">
                <label for="category" class="form-label">Categoría:</label>
                <p>
                  <select name="category" id="category">
                    <option
                      value=""
                      disabled
                      selected
                    >
                      - selecciona la categoria -
                    </option>
                    <% if (locals.oldData) { %>
                      <% categories.forEach(category => { %>
                        <option value="<%= category.id %>" 
                          <%= (category.id==oldData.category)?'selected':'' %>
                          ><%=category.name %></option>
                    <% }) %>
                    <% } else { %>
                      <% categories.forEach(category => { %>
                      <option value="<%= category.id %>"><%=category.name %></option>
                      <% }) %>
                    <% } %>
                  </select>
                  <br />
                </p>
              </div>

              <% if(locals.errors && errors.category) {%>
              <div class="text-danger errores"><%= errors.category.msg %></div>
              <% } %>

              <div class="label-input">
                <label for="descripcion" class="form-label">Descripción:</label>
                <textarea
                  id="descripcion"
                  name="descripcion"
                  placeholder="Descripción del producto"
                  class="description-input"><%= locals.oldData ? oldData.descripcion : null %></textarea>
              </div>
              <% if(locals.errors && errors.descripcion) {%>
              <div class="text-danger errores"><%= errors.descripcion.msg %></div>
              <% } %>

              <div class="label-input">
                <label for="foto" class="form-label">Imagen del producto:</label>
                <input
                  type="file"
                  id="image_id"
                  name="foto"
                  class="input-foto"/>
              </div>
              <% if(locals.errors && errors.image) {%>
              <div class="text-danger errores"><%= errors.image.msg %></div>
              <% } %>

              <div>
                <input type="submit" class="boton-crear" value="Crear" />
              </div>
            </div>
          </form>
        </div>
    </main>


    <script src="/js/crear-productoValidation.js"></script>
  </body>
</html>
